webpackJsonp([1,2],{22:function(e,t){},23:function(e,t,a){a(67);var n=a(6)(a(46),a(72),null,null);e.exports=n.exports},46:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(71),i=a.n(n);t.default={name:"app",components:{Tab:i.a}}},47:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={data:function(){return{config:{},labelPosition:"left"}},methods:{getConfig:function(){var e=this;this.$http.get("/api/config").then(function(t){console.log("get config ... ",t),e.config=t.body})},updateConfig:function(){console.log("updateConfig ... ",this.config);var e=this;e.$http.post("/api/config",e.config).then(function(t){e.$message({message:"config changed",type:"warning"}),e.$root.$data.eventHub.$emit("tab-change","first")})},onchange:function(e,t){this.config[e]=t}},mounted:function(){this.getConfig(),console.log("config ... ",this.config)}}},48:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(12);a.n(n);t.default={name:"home",data:function(){return{keysTreeData:[],treeProps:{children:"children",label:"name"},tableData:[],dialogFormVisible:!1,detailForm:{},redisCmd:"",oldField:"",oldValue:"",dialogOpenStatus:!1,selectedNode:null,detailIndex:0}},computed:{dialogTitle:function(){var e=this.detailForm.type?this.detailForm.type:"-";return this.detailForm.fullName+"  ["+e+"]"}},methods:{exec:function(){var e=this,t=this;t.$http.post("/api/exec",{cmd:this.redisCmd}).then(function(a){console.log("resp after exec ... ",a);var n=e.redisCmd.toLowerCase();if(n.includes("select")){t.$message({message:"db changed",type:"warning"});var i=JSON.parse(a.body.resp);console.log("data .... ",i),t.keysTreeData=i&&i.children?i.children:[],t.tableData=i&&i.children?[i.children[0]]:[]}else if(n.includes("keys")){var o=JSON.parse(a.body.resp);console.log("data .... ",o),t.tableData=o&&o.children?o.children:[]}else t.$message(a.body.resp)})},showDetail:function(e,t){this.dialogFormVisible=!0,this.detailForm=e,this.detailIndex=t},dialogDelAll:function(e){var t=this,a={fullName:this.detailForm.fullName,type:this.detailForm.type,ope:2};t.$http.post("/api/modify",a).then(function(e){if(t.tableData.splice(t.detailIndex,1),0===t.tableData.length)for(var a=0;a<t.selectedNode.parent.children.length;a++)t.selectedNode.parent.children[a].fullName===t.detailForm.fullName&&t.selectedNode.parent.children.splice(a,1);t.dialogFormVisible=!1})},dialogDel:function(e){var t={fullName:this.detailForm.fullName,type:this.detailForm.type,ope:1};this.detailForm.data[e].field?t.field=this.detailForm.data[e].field:t.field=this.detailForm.data[e].value;var a=this;a.$http.post("/api/modify",t).then(function(t){if(a.detailForm.data.splice(e,1),0===a.detailForm.data.length){if(a.tableData.splice(a.detailIndex,1),0===a.tableData.length)for(var n=0;n<a.selectedNode.parent.children.length;n++)a.selectedNode.parent.children[n].fullName===a.detailForm.fullName&&a.selectedNode.parent.children.splice(n,1);a.dialogFormVisible=!1}})},onchange:function(e,t,a){var n=this;this.dialogOpenStatus&&!function(){console.log("onchange ....");var i={fullName:n.detailForm.fullName,type:n.detailForm.type,ope:t};3===t?(i.oldValue=n.detailForm.data[e].value,i.value=a,n.detailForm.data[e].value=a):(i.oldField=n.detailForm.data[e].field,i.field=a,n.detailForm.data[e].field=a);var o=n;o.$http.post("/api/modify",i).then(function(e){o.$message({message:"updated",type:"info"})})}()},fetchData:function(){var e=n.Loading.service({body:!0}),t=this;t.$http.get("/api/api").then(function(a){a.body.children&&a.body.children.length?(t.addNodeParent(a.body,a.body.children),t.keysTreeData=a.body.children):t.keysTreeData=[],t.redisCmd="",t.tableData=[],e.close()})},nodeClick:function(e){if(this.selectedNode=e,e.children&&e.children.length){for(var t=[],a=0;a<e.children.length;a++)e.children[a].data&&t.push(e.children[a]);this.tableData=t}else this.tableData=[e]},valueColumnIf:function(e){return!!(e.data&&"string"===e.type&&e.data&&e.data.length)},dialogClose:function(){console.log("dialogClose ..... "),this.detailForm={},this.dialogOpenStatus=!1},dialogOpen:function(){this.dialogOpenStatus=!0},addNodeParent:function(e,t){if(t&&t.length)for(var a=0;a<t.length;a++)t[a].parent=e,this.addNodeParent(t[a],t[a].children)}},mounted:function(){this.fetchData()},created:function(){var e=this;e.$root.$data.eventHub.$on("home-refresh",function(){console.log("home-refresh event .... "),e.fetchData()})}}},49:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(70),i=a.n(n),o=a(69),l=a.n(o);t.default={components:{home:i.a,config:l.a},data:function(){return{activeName:"first"}},methods:{handleClick:function(e,t){}},created:function(){var e=this;this.$root.$data.eventHub.$on("tab-change",function(t){e.activeName=t,e.$root.$data.eventHub.$emit("home-refresh")})},beforeDestroy:function(){this.$root.$data.eventHub.$off("home-refresh"),this.$root.$data.eventHub.$off("tab-change")}}},67:function(e,t){},68:function(e,t){},69:function(e,t,a){var n=a(6)(a(47),a(73),null,null);e.exports=n.exports},70:function(e,t,a){a(68);var n=a(6)(a(48),a(74),null,null);e.exports=n.exports},71:function(e,t,a){var n=a(6)(a(49),a(75),null,null);e.exports=n.exports},72:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"app"}},[a("tab")],1)},staticRenderFns:[]}},73:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{xs:20,sm:16,md:14,lg:12}},[a("el-form",{attrs:{"label-position":e.labelPosition,"label-width":"80px"}},[a("el-form-item",{attrs:{label:"URL"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:e.config.url,expression:"config.url"}],attrs:{value:e.config.url},domProps:{value:e.config.url},on:{input:function(t){e.config.url=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"DB"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:e.config.db,expression:"config.db"}],attrs:{type:"number",value:e.config.db},domProps:{value:e.config.db},on:{input:function(t){e.config.db=e._n(t)},blur:function(t){e.$forceUpdate()}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Password"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:e.config.password,expression:"config.password"}],attrs:{value:e.config.password},domProps:{value:e.config.password},on:{input:function(t){e.config.password=t}}})],1),e._v(" "),a("el-form-item",{attrs:{label:"Timeout"}},[a("el-input",{directives:[{name:"model",rawName:"v-model",value:e.config.timeOut,expression:"config.timeOut"}],attrs:{type:"number",value:e.config.timeOut},domProps:{value:e.config.timeOut},on:{input:function(t){e.config.timeOut=e._n(t)},blur:function(t){e.$forceUpdate()}}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.updateConfig}},[e._v("更新")])],1)],1)],1)],1)},staticRenderFns:[]}},74:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-row",{attrs:{gutter:23}},[a("el-col",{attrs:{span:6}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-tree",{attrs:{data:e.keysTreeData,props:e.treeProps},on:{"node-click":e.nodeClick}})],1)]),e._v(" "),a("el-col",{attrs:{span:16}},[a("div",{staticClass:"grid-content bg-purple"},[a("el-row",[a("el-form",{attrs:{inline:!0,id:"home-form"},nativeOn:{submit:function(e){e.preventDefault()}}},[a("el-form-item",[a("el-input",{directives:[{name:"model",rawName:"v-model",value:e.redisCmd,expression:"redisCmd"}],attrs:{type:"text",placeholder:"命令"},domProps:{value:e.redisCmd},on:{input:function(t){e.redisCmd=t}}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary",disabled:!e.redisCmd},on:{click:e.exec}},[e._v("执行")])],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:e.fetchData}},[e._v("刷新")])],1)],1)],1),e._v(" "),a("el-row",[a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,border:""}},[a("el-table-column",{attrs:{prop:"name",label:"key"}}),e._v(" "),a("el-table-column",{attrs:{label:"value"},scopedSlots:{default:function(t){return[e.valueColumnIf(t.row)?a("p",[e._v(e._s(t.row.data[0].value))]):a("p",[e._v("Object")])]}}}),e._v(" "),a("el-table-column",{attrs:{label:"type"},scopedSlots:{default:function(t){return[t.row.type?a("p",[e._v(e._s(t.row.type))]):a("p",[e._v("--")])]}}}),e._v(" "),a("el-table-column",{attrs:{label:"操作"},scopedSlots:{default:function(t){return[a("el-button",{attrs:{size:"small"},on:{click:function(a){e.showDetail(t.row,t.$index)}}},[e._v("详细")])]}}})],1)],1)],1)])],1),e._v(" "),a("el-dialog",{directives:[{name:"model",rawName:"v-model",value:e.dialogFormVisible,expression:"dialogFormVisible"}],attrs:{id:"detail-dialog",title:e.dialogTitle},domProps:{value:e.dialogFormVisible},on:{close:e.dialogClose,open:e.dialogOpen,input:function(t){e.dialogFormVisible=t}}},[a("div",{attrs:{id:"home-dialog-form-label"}},[a("p",{attrs:{id:"field-label"}},[e._v("field")]),a("p",{attrs:{id:"value-label"}},[e._v("value")])]),e._v(" "),a("el-form",{staticClass:"demo-form-inline",attrs:{inline:!0,model:e.detailForm}},[e._l(e.detailForm.data,function(t,n){return e.detailForm.data&&e.detailForm.data.length?a("div",{key:t},[a("el-form-item",[t.field?a("el-input",{attrs:{value:t.field},on:{change:function(t){e.onchange(n,4,t)}}}):a("el-input",{directives:[{name:"model",rawName:"v-model",value:t.field,expression:"form.field"}],attrs:{value:"--",disabled:!0},domProps:{value:t.field},on:{input:function(e){t.field=e}}})],1),e._v(" "),a("el-form-item",[a("el-input",{attrs:{value:t.value},on:{change:function(t){e.onchange(n,3,t)}}})],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:function(t){e.dialogDel(n)}}},[e._v("删除")])],1)],1):e._e()}),e._v(" "),"string"!=e.detailForm.type?a("el-form-item",[a("el-button",{on:{click:e.dialogDelAll}},[e._v("全部删除")])],1):e._e()],2)],1)],1)},staticRenderFns:[]}},75:function(e,t){e.exports={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-tabs",{directives:[{name:"model",rawName:"v-model",value:e.activeName,expression:"activeName"}],domProps:{value:e.activeName},on:{"tab-click":e.handleClick,input:function(t){e.activeName=t}}},[a("el-tab-pane",{attrs:{label:"主页",name:"first"}},[a("home")],1),e._v(" "),a("el-tab-pane",{attrs:{label:"配置管理",name:"second"}},[a("config")],1)],1)},staticRenderFns:[]}},78:function(e,t){},79:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(2),i=a.n(n),o=a(23),l=a.n(o),r=a(12),d=a.n(r),s=a(22),c=(a.n(s),a(24)),u=a.n(c);i.a.use(d.a),i.a.use(u.a);var f=new i.a;new i.a({el:"#app",template:"<App/>",components:{App:l.a},data:function(){return{eventHub:f}}})}},[79]);
//# sourceMappingURL=app.896ee7ee139a909d0df8.js.map